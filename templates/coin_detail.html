{% extends "base.html" %}

{% block title %}{{ coin_name }}{% endblock %}

{% block content %}
<div class="container text-center mt-5">
    <h1>{{ coin_name }} ({{ coin_symbol }})</h1>
    <p>ğŸ’° Current Price: ${{ "%.2f"|format(coin_price) }}</p>
    <p>ğŸ¦ Market Cap: ${{ "{:,}".format(coin_market_cap) }}</p>
    <p style="max-width:800px; margin:auto;">{{ coin_desc | safe }}</p>

    <hr class="my-4">

    <h4>Price Chart</h4>

    <div class="btn-group mb-4">
        <button class="btn btn-outline-primary" onclick="loadChart(7)">7 Days</button>
        <button class="btn btn-outline-primary" onclick="loadChart(14)">2 Weeks</button>
        <button class="btn btn-outline-primary" onclick="loadChart(30)">1 Month</button>
    </div>

    <div>
        <img id="chartImage" src="{{ chart_url }}" alt="{{ coin_name }} chart" height="300">
    </div>
</div>

<script>
async function loadChart(days) {
    const img = document.getElementById("chartImage");

    const res = await fetch(`/coin/{{ coin_id }}/chart?days=${days}&symbol={{ coin_symbol }}`);
    const data = await res.json();

    img.src = data.chart_url + "?t=" + Date.now();
}
</script>



{% endblock %}
